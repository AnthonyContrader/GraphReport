<div class="contenitore">
    
    <div class="cols-menu" *ngIf="owner && pronto">
        <button type="button" class="menubtn" 
            (click)="addsetcollapse()">
            <i class="fa fa-line-chart" style="margin-right: 15px"></i> Aggiungi set
        </button>
        <div [ngClass]="(!isAddsetCollapsed)?'collapsebtn':'collapsebtn openAdd'">
            <form [formGroup]="formCrea" (ngSubmit)="addSet(formCrea.value)"> 
                <label>Asse X</label>
                <select formControlName="x" style="width: 100%;"> 
                    <option [value]="null" style="color:grey" >Seleziona</option>
                    <option *ngFor="let c of umList" [value]="c.id">{{c.unitaMisuraN}} {{c.commento}}</option> 
                </select>
                <label>Asse Y</label>
                <select formControlName="y" style="width: 100%;"> 
                    <option [value]="null" style="color:grey">Seleziona</option>
                    <option *ngFor="let c of umList" [value]="c.id">{{c.unitaMisuraN}} {{c.commento}}</option> 
                </select>
                <label style="margin-bottom:1px;">Asse Z </label><label style="font-size:10px; margin: 0;"> Solo tipo BOUBLE</label>
                <select formControlName="z" style="width: 100%;"> 
                    <option [value]="null" style="color:grey">Seleziona</option>
                    <option *ngFor="let c of umList" [value]="c.id">{{c.unitaMisuraN}} {{c.commento}}</option> 
                </select>                
                <button type="submit" class="menubtn" style="background-color: #334247; margin: 10px 0px;">Crea</button>
            </form>
        </div>
        <button type="button" class="menubtn" data-toggle="collapsebtn" data-target="#option"
            (click)="optioncollapse()">
            <i class="fa fa-cogs" style="margin-right: 15px"></i>Opzioni
        </button>
        <div [ngClass]="(!isOptionCollapsed)?'collapsebtn':'collapsebtn openOption'">
            
            <label >Tipologia Grafico</label>
            <select [(ngModel)]="graph.tipografico" [disabled]="mix"> 
                <option *ngFor="let c of keys(enumTipoGrafico)" [value]="c">{{enumTipoGrafico[c]}}</option> 
            </select>
            <div class="cntOption">
                <div>
                    <input id="optTit" type="checkbox" class="inpOption" [(ngModel)]="graph.titoloBool" style="margin:0px 3px;width:max-content"/>
                    <label for="optTit" class="lblOption" style="margin:0px 3px">Titolo</label>
                    <input type="text" class="inpOption" [(ngModel)]="graph.titolo" style="margin:0px 3px"/>
                    <label style="margin-top:3px">Font</label>
                    <select [(ngModel)]="graph.fontStyle"> 
                        <option *ngFor="let c of keys(enumFont)" [value]="c">{{enumFont[c]}}</option> 
                    </select>
                    <div style="display: flex;">
                        <div style="width:40%;padding:0 1px;">
                            <label style="margin-top:3px">Size</label>
                            <input [(ngModel)]="graph.fontSize" type="number"  />
                        </div>
                        <div style="width:60%;padding:0 1px;">
                            <label style="margin-top:3px;width: 100%;">Position:</label>
                            <select [(ngModel)]="graph.posTitolo"> 
                                <option value="top">Top</option> 
                                <option value="bottom">Bottom</option> 
                                <option value="left">Left</option> 
                                <option value="right">Right</option> 
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <div class="cntOption">
                <div>
                    <input id="optLeg" type="checkbox" class="inpOption" [(ngModel)]="graph.legenda" style="margin:0px 3px;width:max-content"/>
                    <label class="lblOption" style="margin:0px 3px;" for="optLeg">Legenda</label>
                    <label style="margin-top:3px;width: 100%;">Position:</label>
                    <select [(ngModel)]="graph.posLegenda"> 
                        <option value="top">Top</option> 
                        <option value="bottom">Bottom</option> 
                        <option value="left">Left</option> 
                        <option value="right">Right</option> 
                    </select>
                </div>
            </div>

            <input id="optPareto" type="checkbox" class="inpOption" [(ngModel)]="graph.pareto" style="margin:0px 3px;width:max-content" (change)="mixed()"/>
            <label class="lblOption" style="margin:10px 3px" for="optPareto">Pareto</label>
                    
            <button (click)="salvaOpzioni()" class="menubtn" style="background-color: #334247; margin: 10px 0px;">Salva</button>
        </div>
        <button type="button" class="menubtn" data-toggle="collapsebtn" data-target="#export"
            (click)="exportcollapse()">
            <i class="fa fa-external-link" style="margin-right: 15px"></i>Esporta
        </button>
        <div [ngClass]="(!isExportCollapsed)?'collapsebtn':'collapsebtn openExport'">
            <button class="menubtn" style="background-color: #334247; margin: 10px 0;" (click)="esporta('png')">
                    As PNG
            </button>
            <!--<button class="menubtn" style="background-color: #334247; margin-bottom: 10px;" (click)="esporta('jpeg')">
                As JPG
        </button>-->
            <a [href]="esportalink" [download]="esportaname" #download></a>
        </div>
    </div>
    <div id="contCanvas" class="cols-rest" *ngIf="pronto" >
        <canvas #esporta baseChart
            [datasets]="datasets"
            [labels]="labels"
            [options]="options"
            [colors]="colors"
            [legend]="graph.legenda"
            [chartType]="chartType"
            (chartHover)="chartHovered($event)"
            (chartClick)="chartClicked($event)">
        </canvas>
    </div>
    <div *ngIf="err!=0" class="error">
        <label class="closerr" (click)="closerror()">[X] Chiudi</label>
        <container-element [ngSwitch]="err">
            <p *ngSwitchCase="1">
                <strong>Attenzione:</strong><br> Si prega di compilare correttamente i campi.
            </p>
        </container-element>
    </div>
</div>