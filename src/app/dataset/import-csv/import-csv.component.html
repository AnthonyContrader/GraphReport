<div class="container-fluid scrollable max-dim">
    <div class="max-center" *ngIf="!stamp">
        <input type="file" accept=".csv" id="herecsv" style="display: none;" (change)="readIt($event)">
        <label for="herecsv" class="drophere">
        <div class="container">
            drop or click here
        </div>
        </label>
    </div>
    <div class="max-center container" *ngIf="stamp">
        <div class="row">
            <div class="col-6">
                <div class="centrato">
                    <button  type="button" class="btn btn-outline-secondary" (click)="annulla()">Annulla</button>
                </div>
            </div>
            <div class="col-6">
                <div class="centrato">
                    <button  type="button" class="btn btn-outline-secondary" (click)="submit()">Salva</button>
                </div>
            </div>
        </div>
        <div class="row">
            <div class="form-group">
                <label>Titolo</label>
                <input  [(ngModel)]="titolo" type="text" class="form-control form-control-sm" placeholder="Digita il titolo"/>
            </div>
            <div class="form-group">
                <label>Unita di misura</label>
                <select  [(ngModel)]="um" type="text" class="form-control form-control-sm">
                    <option value="0">Colonne</option>
                    <option value="1">Righe</option>
                </select>
            </div>
        </div>

        <div class="container border scrollable" style="height: 80%;">
            <table>
                <tr *ngIf="um==0">
                    <th>
                        <label>Categoria</label>
                        <label>Unità</label>
                    </th>
                    <th *ngFor="let a of csvRecords[0]; let i=index" class="form-group">
                        <select class="form-control form-control-sm" (change)="caricaUm(i,$event.target.value)">
                            <option></option>
                            <option *ngFor="let x of categorie" [value]="x.id">{{x.nome}}</option>
                        </select>
                        <select [(ngModel)]="umScelte[i]" class="form-control form-control-sm">
                            <option *ngFor="let z of listUm[i]" [value]="z.id">{{z.nome}}</option>
                        </select>
                    </th>
                </tr>
                <tr>
                    <th *ngIf="um==1">
                        <label>Categiaria</label>
                        <label>Unità</label>
                    </th>
                    <th></th>
                    <th *ngFor="let a of csvRecords[0];let c=index">
                        <fa-icon [icon]="delete" title="Elimina colonna" (click)="elimina((c+1))"></fa-icon>
                    </th>
                </tr>
                <tr *ngFor="let row of csvRecords; let r=index">
                    <td *ngIf="um==1">
                        <select class="form-control form-control-sm" (change)="caricaUm(r,$event.target.value)">
                            <option></option>
                            <option *ngFor="let x of categorie" [value]="x.id">{{x.nome}}</option>
                        </select>
                        <select [(ngModel)]="umScelte[r]" class="form-control form-control-sm">
                            <option *ngFor="let z of listUm[r]" [value]="z.id">{{z.nome}}</option>
                        </select>
                    </td>
                    <td>
                        <fa-icon [icon]="delete" title="Elimina riga" (click)="elimina((r+1)*(-1))"></fa-icon>
                    </td>
                    <td *ngFor="let col of csvRecords[r]; let c=index">
                        {{csvRecords[r][c]}}
                    </td>
                </tr>
            </table>
        </div>

    </div>
</div>