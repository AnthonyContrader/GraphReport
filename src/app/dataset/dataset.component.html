<div class="row" style="height: calc(100vh - 39px); overflow:auto;">
    <div class="col-md-4">
        <form class="center" *ngIf="isAdmin" style="width:270px; margin-top: 20px;">
            <label>Visualizza DataSet dell'utente</label>
            <select [value]="userid" (change)="caricaDS($event.target.value)">
                <option *ngFor="let u of utList" [value]="u.id" [selected]="u.id==userid">{{u.firstName}}</option>
            </select>
        </form>
        <div style="padding-top: 25px;">
            
            <h2 style="text-align: center;">Crea nuovo DataSet</h2>
            <form style="min-width:270px" [formGroup]="createForm" (ngSubmit)="createDS(createForm.value)">

                <label><strong>Inserire il titolo</strong></label>
                <input formControlName="tit" type="text" [value]="dataset.titolo" required>

                <label><strong>Categoria - Primo set di valori</strong></label>
                <select formControlName="cat" (change)="filtra($event.target.value)" required>
                    <option [ngValue]="null" style="color:grey" selected>Scegli una categoria</option>
                    <option *ngFor="let c of ListCategoria" [value]="c.id">{{c.nome}}</option>
                </select>
                <label style="margin-top:5px"><strong>Unità di misura:</strong></label>
                <br>
                <select formControlName="ump" required>
                    <option [ngValue]="null" style="color:grey">Scegli un'unità di misura</option>
                    <option *ngFor="let c of ListaFiltrata" [value]="c.id">{{c.nome}}</option>
                </select>

                <label><strong>Categoria - Secondo set di valori</strong><i> (opzionale)</i></label>
                <select formControlName="cat2" (change)="filtra2($event.target.value)">
                    <option [ngValue]="null" style="color:grey" selected>Scegli una categoria</option>
                    <option *ngFor="let c of ListCategoria" [value]="c.id">{{c.nome}}</option>
                </select>
                <label style="margin-top:5px"><strong>Unità di misura:</strong></label>
                <br>
                <select formControlName="ums">
                    <option [ngValue]="null" style="color:grey">Scegli un'unità di misura</option>
                    <option *ngFor="let c of ListaFiltrata2" [value]="c.id">{{c.nome}}</option>
                </select>
                <button type="submit">Crea</button>
            </form>

        </div>
    </div>
    <div class="col-md-8">
        <div class="row col-md-12" *ngFor="let unita of ListaDatasetByUser; let riga=index;">
            <ng-container *ngIf="((riga==0) || (unita.titolo != ListaDatasetByUser[(riga-1)].titolo))"> 
                    <div style="width: 100%;text-align: center; margin-top: 20px;"><h3>{{unita.titolo}}</h3></div>
                    <div class="newCat" style="margin-top: 24px;">
                        <div class="divCRUD" style="width:20%;">
                            <a [routerLink]="[pathModify]" [queryParams]="{id: unita.titolo}"><div class="linkCRUD">Modifica</div></a>
                            <label (click)="dele(unita.titolo)"><div class="linkCRUD">Elimina</div></label>
                        </div>
                    </div>
                    <div class="row table" style="width: max-content; min-width: max-content; margin:auto; margin-bottom: 20px;">
                        <div class="col" style="max-width: min-content;padding: 0px !important" *ngFor="let x of Ntitolo(unita.titolo); let j = index">
                            <div class="th tc" style="min-width:50px;text-align:center;box-sizing: border-box; margin-top: 5px;">
                                {{findUmNome(x.idUnita)}}
                                <div class="btnComm toltip" style="cursor: pointer;">
                                    <img src="../../assets/comm.png" (click)="addComm(j)"/>
                                    <span class="toltiptext">
                                        <p>{{x.commento}} </p>
                                            <div *ngIf="(x.commento!='')" class="sugg">Clicca per modificare</div>
                                            <div *ngIf="(x.commento=='')" class="sugg">Clicca per aggiungere</div>
                                    </span>
                                </div>
                            </div>
                            <div [ngClass]="(colonna%2==0)? 'tc white':'tc grey'" style="min-width:50px;text-align:center;box-sizing: border-box;" 
                            *ngFor="let valore of x.valori.split('_'); let colonna=index">{{valore}}
                            </div>
                        </div>
                    </div>
            </ng-container>
        </div>
    </div>
    
    <div *ngIf="del!=''" class="error">
    <p>
        <strong>Sei sicuro di voler eliminare questo DataSet?</strong>
    </p>
    <label class="delbutton" (click)="deleteDS()">Prosegui</label>
    <label class="delbutton" (click)="del=''">Annulla</label>
</div>
</div>
